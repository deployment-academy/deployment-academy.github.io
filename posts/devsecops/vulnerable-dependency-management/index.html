<!doctype html><html class=no-js lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="IE=edge">
<title>Vulnerable Dependency Management: The Invisible Enemy - Deployment</title>
<script>(function(a,b){a[b]=a[b].replace("no-js","js")})(document.documentElement,"className")</script>
<meta name=description content="Security considerations about dependency management.">
<meta property="og:title" content="Vulnerable Dependency Management: The Invisible Enemy">
<meta property="og:description" content="Security considerations about dependency management.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://deployment.properties/posts/devsecops/vulnerable-dependency-management/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-08-22T12:52:20-04:00">
<meta property="article:modified_time" content="2021-08-25T12:56:20-04:00">
<meta itemprop=name content="Vulnerable Dependency Management: The Invisible Enemy">
<meta itemprop=description content="Security considerations about dependency management."><meta itemprop=datePublished content="2021-08-22T12:52:20-04:00">
<meta itemprop=dateModified content="2021-08-25T12:56:20-04:00">
<meta itemprop=wordCount content="1375">
<meta itemprop=keywords content="devsecops,application security,appsec,dependency management,vulnerability management,software composition analysis,sca,">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Vulnerable Dependency Management: The Invisible Enemy">
<meta name=twitter:description content="Security considerations about dependency management.">
<link rel=preconnect href=https://fonts.gstatic.com crossorigin>
<link rel=dns-prefetch href=//fonts.googleapis.com>
<link rel=dns-prefetch href=//fonts.gstatic.com>
<link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
<link rel=stylesheet href=/css/style.css>
<link rel=stylesheet href=/css/custom.css>
<link rel="shortcut icon" href=/favicon.ico>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0BJEGTESYY"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-0BJEGTESYY',{anonymize_ip:!1})}</script>
</head>
<body class=body>
<div class="container container--outer">
<header class=header>
<div class="container header__container">
<div class=logo>
<a class=logo__link href=/ title=Deployment rel=home>
<div class="logo__item logo__text">
<div class=logo__title>Deployment</div>
<div class=logo__tagline>A tech blog focused on Software Engineering and DevSecOps</div>
</div>
</a>
</div>
<nav class=menu>
<button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span>
</button>
<ul class=menu__list>
<li class=menu__item>
<a class=menu__link href=/about/>
<span class=menu__text>About</span>
</a>
</li>
</ul>
</nav>
</div>
</header>
<div class="wrapper flex">
<div class=primary>
<main class=main role=main>
<article class=post>
<header class=post__header>
<h1 class=post__title>Vulnerable Dependency Management: The Invisible Enemy</h1>
<div class="post__meta meta"><div class="meta__item-author meta__item">
<svg class="meta__icon icon icon-author" width="16" height="16" viewBox="0 0 12 16"><path d="M6 1c2.2.0 3.5 2 3.5 4.5C9.5 7 8.9 8.2 8 9c2.9.8 4 2.5 4 5v1H0v-1c0-2.5 1.1-4.2 4-5-.9-.8-1.5-2-1.5-3.5C2.5 3 3.8 1 6 1z"/></svg><span class=meta__text>Romulo Santos</span>
</div>
<div class="meta__item-datetime meta__item">
<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2021-08-22T12:52:20-04:00>2021-08-22</time>
<time class=meta__text datetime=2021-08-25T12:56:20-04:00>(Last Modified: 2021-08-25)</time></div></div>
</header><div class="content post__content clearfix">
<p>Let&rsquo;s talk about something that most developers and engineering teams don&rsquo;t pay the necessary attention to. Do you have a process to update your application dependencies? How likely is it that your application could be compromised because of a vulnerable dependency?</p>
<blockquote>
<p><strong>TL;DR</strong> - In this post, we are going to review a few points and see why you shouldn&rsquo;t assume an ad-hoc posture in terms of upgrading your dependencies and that you should strongly consider automating dependency vulnerability checks in your CICD pipeline.</p>
</blockquote>
<h2 id=dependency-management-overview>Dependency Management Overview</h2>
<p>Regardless of the platform you use (Java, Go, Python, PHP, .Net, etc.), your application likely relies on external dependencies - probably tens or hundreds of them. In fact, we can fairly say that most of the code for any modern application comes from third-party open-source libraries and frameworks. The <a href=https://www.veracode.com/state-of-software-security-report>State of Software Security Report v11</a> points that <strong>97% of a typical Java application is composed of open-source libraries</strong>. While this number is unusual, on average we can expect that <strong>about 70% of modern applications will be composed of third-party open-source libraries</strong>, according to the <a href=https://www.synopsys.com/software-integrity/resources/analyst-reports/open-source-security-risk-analysis.html>Synopsys Open Source Security Risk Analysis</a>.</p>
<p>Modern applications use dependency management tools like Maven, NuGet, NPM, Pip to automate installing and configuring external libraries during the build time. Using third-party components can lead to increased developer productivity allowing developers to focus on the target domain while reusing cross-cutting specialized features. These features can vary from simple utilities, like string formatting or arrays manipulation, to more complex features that take care of some core behavior of an application, such as HTTP handling, Object Relationship Mapping, or a Dependency Injection framework.</p>
<h2 id=security-considerations>Security Considerations</h2>
<p>Having visibility and control over the security risks presented by external dependencies is as critical as having good security practices for your own code. You can design and write secure code and still be compromised by a bad design choice or implementation made by a library. The same <a href=(https://www.veracode.com/state-of-software-security-report)>State of Software Security Report v11</a> mentioned before has also identified that <strong>about seven in every ten applications were found to have flaws in their open-source libraries</strong> on initial scan. And, <strong>about three in every ten applications have more flaws in their open-source libraries than in the primary codebase</strong>.</p>
<p>Vulnerable dependencies have been on the industry&rsquo;s radar for a while because they can cause serious losses. The OWASP Top 10 <a href=https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities>A9-Using Components with Known Vulnerabilities</a> item was introduced in 2013 and is still present in the 2017 version. Other important controls and standards, like the <a href="https://www.pcisecuritystandards.org/document_library?category=pcidss&document=pci_dss">PCI DSS 3.0</a> and the <a href=https://www.fsisac.com/hubfs/Resources/FSISAC-ThirdPartySecurityControlTypes-Whitepaper_2015.pdf>FS-ISAC</a>, require that third-party system components should be properly handled.</p>
<p>The classic example of an incident caused by a vulnerable dependency is the <a href=https://www.trendmicro.com/en_us/research/17/c/cve-2017-5638-apache-struts-vulnerability-remote-code-execution.html>Equifax data breach</a> where a <a href=https://nvd.nist.gov/vuln/detail/CVE-2017-5638>Remote Code Execution (RCE) vulnerability</a> in the Apache Struts 2 framework led to the expose of personal data (PII) of millions of Americans.</p>
<h2 id=dependency-upgrade-approaches>Dependency Upgrade Approaches</h2>
<p>To properly understand how vulnerable dependencies enter and persist in a codebase, we need to understand some different approaches engineering teams take to keep dependencies up to date. In this way, you can evaluate what you are doing and what options work best for you.</p>
<p>These are some common approaches we can see in terms of dependency upgrades:</p>
<p><strong>Ad-hoc</strong> - The most common (and what I would call the default approach) is to upgrade a dependency when you need a new feature or not upgrade at all otherwise. Besides the obvious issue of using old and often deprecated or unsupported features, one of the main problems with this approach is that the longer you take to upgrade a dependency, the more extensive the effort will be. Evaluating the changelog and the impact of an upgrade is more complicated when there is a significant drift between versions. Of course, this isn&rsquo;t good from a security perspective either. Besides keeping vulnerable code in your codebase, security patches may not be backported to older versions and the time and effort to patch a critical vulnerability may not meet business expectations.</p>
<p><strong>Latest version</strong> - Staying up to date with the latest version of your dependencies is usually the recommended approach. Being up to date with the latest version of libraries will keep you up to date with new features, bug fixes and security patches. But it also brings a risk that cannot be ignored. You might be impacted by new bugs or flaws introduced in the third-party library. Depending on the requirements and criticality of your application, it might be a good idea to keep a more conservative cadence of updates - mainly for core frameworks. To follow this approach, it&rsquo;s ideal to have an automated CICD pipeline and a mature continuous delivery process to support frequent rollouts and quick rollbacks. Proper code coverage and automated tests will help you to validate upgrades and changes.</p>
<p><strong>Follow the dependency release cycle</strong> - Many teams will consider a more conservative approach and follow the release cycle of dependencies (when it&rsquo;s available). This approach is particularly interesting for core frameworks where being on top of the latest version can be risky (from reliability and security perspectives) and/or operationally expensive. Some frameworks have a release process that supports and backports fixes up to a certain number of supported versions, with some having what we call a long-term support (LTS) version. Being within a supported version would be considered a reasonable enough approach for most cases.</p>
<p><strong>Security patches</strong> - Another common approach in the industry is to update dependencies only when critical security patches are available. While this approach might help secure your application, you are still prone to merging with a large backlog of changes when an issue is disclosed. This might require a significant code change, and something that could take minutes of engineering time may take hours or sometimes days.</p>
<p>It&rsquo;s also not necessary to pick one of these approaches. You might come up with a mixed approach where you would be always on the latest version for utility libraries and follow the dependency release cycle for more critical components.</p>
<p>While an ad-hoc posture is not advised, <strong>choosing the best approach to manage your dependencies should take into account your application characteristics and threat model</strong>.</p>
<h2 id=tools-overview>Tools Overview</h2>
<p>Regardless of your dependency management approach, it&rsquo;s essential to have an automated step baked into your pipeline to check and alert for vulnerabilities. A good vulnerability scanner or software composition analysis tool will help you find issues earlier in the SDLC and take the necessary actions.</p>
<p>There are some interesting tools in the industry to help with this. Some are commercial, others are open-source software, and others have a hybrid model. They will vary in features and focus (for example, some focus on scanning container images, others on code repository scanning, while others are complete security suites with various features). You should evaluate which tool fits your requirements and profile best. Below is a list of some well-known tools, in no specific order:</p>
<ul>
<li><a href=https://snyk.io/>Snyk</a></li>
<li><a href="https://www.sonatype.com/products/open-source-security-dependency-management?topnav=true">Nexus Lifecycle</a></li>
<li><a href=https://www.synopsys.com/blogs/software-security/manage-open-source-black-duck/>Black Duck SCA</a></li>
<li><a href=https://docs.github.com/en/code-security/supply-chain-security/keeping-your-dependencies-updated-automatically/about-dependabot-version-updates>GitHub Dependabot</a></li>
<li><a href=https://www.whitesourcesoftware.com/>WhiteSource</a></li>
<li><a href=https://www.veracode.com/products/software-composition-analysis>Veracode SCA</a></li>
<li><a href=https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-admin-compute/vulnerability_management.html>Prisma Cloud Compute Edition</a></li>
<li><a href=https://aquasecurity.github.io/trivy>Trivy</a></li>
<li><a href=https://owasp.org/www-project-dependency-check/>OWASP Dependency Check</a></li>
</ul>
<p>This list is not comprehensive, and I recommend that you do your own research if you are interested in finding a provider. You might also be able to solve this problem with a complete open-source solution (which sounds like an interesting topic for another blog post 🙂). The <a href=https://www.linuxfoundation.org/wp-content/uploads/An-Open-Guide-To-Evaluating-Software-Composition-Analysis-Tools_V2.pdf>Open Guide To Evaluating Software Composition Analysis Tools</a> provides a comprehensive baseline for researching tools to prevent vulnerable dependencies (which is not limited to SCA tools). Another valuable resource is the <a href=https://cheatsheetseries.owasp.org/cheatsheets/Vulnerable_Dependency_Management_Cheat_Sheet.html>OWASP Vulnerable Dependency Management Cheat Sheet</a>.</p>
<h2 id=conclusion>Conclusion</h2>
<p>Most of your application is composed of third-party open-source libraries. Taking care of this code is as important as taking care of your own code. An ad-hoc or negligent dependency management posture can lead you to a high-risk and vulnerable position. You should act proactively to upgrade your dependencies and bake vulnerability discovery into your development life cycle, preferably in the CICD pipeline, to anticipate remediation.</p>
<h2 id=feedback>Feedback</h2>
<p>Have comments or feedback? Feel free to share in the thread below:</p>
<blockquote class=twitter-tweet><p lang=en dir=ltr>I tried to put together my developer experience with some security research I have done recently to come up with a few thoughts about vulnerability management in application dependencies, which I'm sharing in this blog post: <a href=https://t.co/Kc5teWFDKY>https://t.co/Kc5teWFDKY</a></p>&mdash; Romulo Santos (@soeiro_santos) <a href="https://twitter.com/soeiro_santos/status/1431023458734034944?ref_src=twsrc%5Etfw">August 26, 2021</a></blockquote>
<script async src=https://platform.twitter.com/widgets.js></script>
</div>
<footer class=post__footer>
<div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg>
<ul class=tags__list>
<li class=tags__item>
<a class="tags__link btn" href=/tags/devsecops/ rel=tag>devsecops</a>
</li>
<li class=tags__item>
<a class="tags__link btn" href=/tags/application-security/ rel=tag>application security</a>
</li>
<li class=tags__item>
<a class="tags__link btn" href=/tags/appsec/ rel=tag>appsec</a>
</li>
<li class=tags__item>
<a class="tags__link btn" href=/tags/dependency-management/ rel=tag>dependency management</a>
</li>
<li class=tags__item>
<a class="tags__link btn" href=/tags/vulnerability-management/ rel=tag>vulnerability management</a>
</li>
<li class=tags__item>
<a class="tags__link btn" href=/tags/software-composition-analysis/ rel=tag>software composition analysis</a>
</li>
<li class=tags__item>
<a class="tags__link btn" href=/tags/sca/ rel=tag>sca</a>
</li>
</ul>
</div>
</footer>
</article>
</main>
</div>
<aside class=sidebar><div class="widget-search widget">
<form class=widget-search__form role=search method=get action=https://duckduckgo.com/>
<label>
<input class=widget-search__field type=search placeholder=SEARCH… name=q aria-label=SEARCH…>
</label>
<input class=widget-search__submit type=submit value=Search>
<input type=hidden name=sites value=https://deployment.properties>
</form>
</div>
<div class="widget-recent widget">
<h4 class=widget__title>Recent Posts</h4>
<div class=widget__content>
<ul class=widget__list>
<li class=widget__item><a class=widget__link href=/posts/devsecops/vulnerable-dependency-management/>Vulnerable Dependency Management: The Invisible Enemy</a></li>
<li class=widget__item><a class=widget__link href=/posts/hugo/hugo-gh-pages-n-actions/>Create a static website with Hugo, GitHub Pages and Actions (in minutes)</a></li>
<li class=widget__item><a class=widget__link href=/posts/devsecops/vault-eks-irsa/>HashiCorp Vault AWS Auth with Amazon EKS and IAM Roles for Service Accounts</a></li>
<li class=widget__item><a class=widget__link href=/posts/devsecops/gke-cloud-endpoints/>Google Cloud Endpoints in GKE with Container-native Load Balancing</a></li>
</ul>
</div>
</div>
<div class="widget-social widget">
<h4 class="widget-social__title widget__title">Social</h4>
<div class="widget-social__content widget__content">
<div class="widget-social__item widget__item">
<a class="widget-social__link widget__link btn" title=Twitter rel="noopener noreferrer" href=https://twitter.com/soeiro_santos target=_blank><svg class="widget-social__link-icon icon icon-twitter" width="24" height="24" viewBox="0 0 384 312"><path d="m384 36.9c-14.1 6.3-29.3 10.5-45.2 12.4 16.3-9.7 28.8-25.2 34.6-43.6-15.2 9-32.1 15.6-50 19.1-14.4-15.2-34.9-24.8-57.5-24.8-43.5.0-78.8 35.3-78.8 78.8.0 6.2.7 12.2 2 17.9-65.5-3.3-123.5-34.6-162.4-82.3C20 26 16.1 39.6 16.1 54c0 27.3 13.9 51.4 35 65.6-12.9-.4-25.1-4-35.7-9.9v1c0 38.2 27.2 70 63.2 77.2-6.6 1.8-13.6 2.8-20.8 2.8-5.1.0-10-.5-14.8-1.4 10 31.3 39.1 54.1 73.6 54.7-27 21.1-60.9 33.7-97.8 33.7-6.4.0-12.6-.4-18.8-1.1C34.9 299 76.3 312 120.8 312c144.9.0 224.1-120 224.1-224.1.0-3.4-.1-6.8-.2-10.2 15.4-11.1 28.7-25 39.3-40.8z"/></svg>
<span>Twitter</span>
</a>
</div>
<div class="widget-social__item widget__item">
<a class="widget-social__link widget__link btn" title=LinkedIn rel="noopener noreferrer" href=https://linkedin.com/in/soeirosantos target=_blank><svg class="widget-social__link-icon icon icon-linkedin" width="24" height="24" viewBox="0 0 352 352"><path d="M0 40v272c0 21.9 18.1 40 40 40h272c21.9.0 40-18.1 40-40V40c0-21.9-18.1-40-40-40H40C18.1.0.0 18.1.0 40zm312-8c4.6.0 8 3.4 8 8v272c0 4.6-3.4 8-8 8H40c-4.6.0-8-3.4-8-8V40c0-4.6 3.4-8 8-8H312zM59.5 87c0 15.2 12.3 27.5 27.5 27.5s27.5-12.3 27.5-27.5S102.2 59.5 87 59.5 59.5 71.8 59.5 87zM187 157h-1v-21h-45v152h47v-75c0-19.8 3.9-39 28.5-39 24.2.0 24.5 22.4 24.5 40v74h47v-83.5c0-40.9-8.7-72-56.5-72-23 0-38.2 12.6-44.5 24.5zM64 288h47.5V136H64V288z"/></svg>
<span>LinkedIn</span>
</a>
</div>
<div class="widget-social__item widget__item">
<a class="widget-social__link widget__link btn" title=GitHub rel="noopener noreferrer" href=https://github.com/soeirosantos target=_blank><svg class="widget-social__link-icon icon icon-github" width="24" height="24" viewBox="0 0 384 374"><path d="m192 0C85.9.0.0 85.8.0 191.7c0 84.7 55 156.6 131.3 181.9 9.6 1.8 13.1-4.2 13.1-9.2.0-4.6-.2-16.6-.3-32.6-53.4 11.6-64.7-25.7-64.7-25.7-8.7-22.1-21.3-28-21.3-28-17.4-11.9 1.3-11.6 1.3-11.6 19.3 1.4 29.4 19.8 29.4 19.8 17.1 29.3 44.9 20.8 55.9 15.9 1.7-12.4 6.7-20.8 12.2-25.6-42.6-4.8-87.5-21.3-87.5-94.8.0-20.9 7.5-38 19.8-51.4-2-4.9-8.6-24.3 1.9-50.7.0.0 16.1-5.2 52.8 19.7 15.3-4.2 31.7-6.4 48.1-6.5 16.3.1 32.7 2.2 48.1 6.5 36.7-24.8 52.8-19.7 52.8-19.7 10.5 26.4 3.9 45.9 1.9 50.7 12.3 13.4 19.7 30.5 19.7 51.4.0 73.7-44.9 89.9-87.7 94.6 6.9 5.9 13 17.6 13 35.5.0 25.6-.2 46.3-.2 52.6.0 5.1 3.5 11.1 13.2 9.2C329 348.2 384 276.4 384 191.7 384 85.8 298 0 192 0z"/></svg>
<span>GitHub</span>
</a>
</div>
</div>
</div>
</aside>
</div>
<footer class=footer>
<div class="container footer__container flex">
<div class=footer__copyright>
&copy; 2021 Deployment - A tech blog focused on Software Engineering and DevSecOps.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span>
</div>
</div>
</footer>
</div>
<script async defer src=/js/menu.js></script>
<script src=/js/custom.js></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
</body>
</html>